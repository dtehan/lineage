# Milestone v2.0: Configuration Improvements

**Status:** ✅ SHIPPED 2026-01-30
**Phases:** 7-8
**Total Plans:** 11

## Overview

This milestone continued from v1.0 (shipped 2026-01-30) to address technical debt and high-priority concerns identified during the production readiness milestone. The focus was on unifying environment variable configuration across the codebase and aligning the database schema with the OpenLineage industry standard for improved interoperability.

## Phases

### Phase 7: Environment Variable Consolidation

**Goal:** Unify Teradata connection configuration across Python scripts and Go/Python server with consistent naming
**Depends on:** v1.0 complete
**Plans:** 3 plans (2 waves)
**Completed:** 2026-01-30

Plans:
- [x] 07-01-PLAN.md - Python configuration consolidation (db_config.py, python_server.py)
- [x] 07-02-PLAN.md - Go configuration consolidation (config.go)
- [x] 07-03-PLAN.md - Documentation consolidation (.env.example, CLAUDE.md, user_guide.md, SECURITY.md)

**Details:**
Standardized on TERADATA_* as primary variable names with TD_* as deprecated legacy fallback. Changed PORT to API_PORT with PORT as fallback. Updated all documentation to reflect consolidated naming.

Wave 1 (parallel):
- Plan 07-01: Python config (TERADATA_* primary, TD_* fallback, API_PORT)
- Plan 07-02: Go config (TD_* fallbacks via Viper, API_PORT)

Wave 2 (sequential):
- Plan 07-03: Documentation updates

**Files Modified:**
- database/db_config.py - Centralized config with priority lookup
- lineage-api/python_server.py - API_PORT support
- lineage-api/internal/infrastructure/config/config.go - Go config with fallbacks
- .env.example, CLAUDE.md, docs/user_guide.md, docs/SECURITY.md - Documentation

**Verification:** All 15/15 observable truths verified. Functional tests pass (TERADATA_* primary, TD_* fallback, precedence, required validation).

### Phase 8: OpenLineage Standard Alignment

**Goal:** Align database LIN_ tables to OpenLineage standard (spec v2-0-2) for interoperability and industry best practices
**Depends on:** Phase 7
**Plans:** 8 plans (6 waves)
**Completed:** 2026-01-30

Plans:
- [x] 08-01-PLAN.md - Database schema (OL_* tables DDL in setup_lineage_schema.py)
- [x] 08-02-PLAN.md - Data population (populate_lineage.py with --openlineage flag)
- [x] 08-03-PLAN.md - Go domain layer (OpenLineage entities and repository interface)
- [x] 08-04-PLAN.md - Go repository (Teradata OpenLineage repository implementation)
- [x] 08-05-PLAN.md - Go service/handlers (v2 API endpoints)
- [x] 08-06-PLAN.md - Frontend types and hooks (TypeScript + TanStack Query)
- [x] 08-07-PLAN.md - Documentation updates (user guide, CLAUDE.md, database README)
- [x] 08-08-PLAN.md - Gap closure: Wire OpenLineage handler in main.go

**Details:**
Transformed custom LIN_* schema to OpenLineage-compliant OL_* tables following spec v2-0-2. Created new tables alongside existing ones for backward compatibility. Exposed v2 API at /api/v2/openlineage/* while maintaining v1 API unchanged.

Wave structure:
- Wave 1: Plan 08-01 (Database schema)
- Wave 2: Plans 08-02, 08-03 (Data population + Go domain) - parallel
- Wave 3: Plan 08-04 (Go repository)
- Wave 4: Plan 08-05 (Go service/handlers)
- Wave 5: Plans 08-06, 08-07 (Frontend + Documentation) - parallel
- Wave 6: Plan 08-08 (Gap closure - main.go wiring)

**Key Changes:**
- New OL_* tables: OL_NAMESPACE, OL_DATASET, OL_DATASET_FIELD, OL_JOB, OL_RUN, OL_COLUMN_LINEAGE
- Namespace URI format: teradata://{host}:{port}
- Transformation types: DIRECT/INDIRECT with subtypes (IDENTITY, TRANSFORMATION, AGGREGATION, JOIN, FILTER, etc.)
- v2 API endpoints alongside existing v1

**Files Created:**
- database/: OL_* DDL in setup_lineage_schema.py, population in populate_lineage.py
- lineage-api/internal/domain/entities.go - OpenLineage entities
- lineage-api/internal/adapter/outbound/teradata/openlineage_repo.go - Repository (768 lines)
- lineage-api/internal/application/openlineage_service.go - Service layer
- lineage-api/internal/adapter/inbound/http/openlineage_handlers.go - HTTP handlers
- lineage-ui/src/types/openlineage.ts - Frontend types
- lineage-ui/src/api/hooks/useOpenLineage.ts - React hooks

**Gap Closure:** Initial verification found v2 API not wired (main.go had nil handler). Fixed in commit 28a9efa - OpenLineage DI chain now fully wired.

**Verification:** All 11/11 observable truths verified. Build succeeds. Re-verified after gap closure.

---

## Milestone Summary

**Key Decisions:**
- Standardize on TERADATA_* as primary environment variables with TD_* as fallback (rationale: clear naming, backwards compatible)
- Use API_PORT instead of PORT for consistency (rationale: avoids conflict with common PORT usage)
- Implement OpenLineage spec v2-0-2 exactly (rationale: future-proof interoperability)
- Create OL_* tables alongside LIN_* tables (rationale: backwards compatibility, gradual migration)
- Expose v2 API at separate /api/v2/openlineage/* endpoint (rationale: API versioning, non-breaking change)

**Issues Resolved:**
- Environment variable inconsistency between Python and Go codebases
- Lack of industry-standard lineage metadata format
- No interoperability with external lineage tools

**Technical Debt Incurred:**
- Frontend pagination controls not implemented (hooks support pagination but UI doesn't expose controls) - MEDIUM priority, affects user experience
- Pagination bounds hardcoded (not configurable via env vars like validation bounds) - LOW priority, defaults are safe
- SetPaginationConfig not called in main.go (uses package-level defaults) - LOW priority, follows validation pattern

**Cross-Phase Integration:**
- Phase 7 env vars → Phase 8 OpenLineage namespace generation (get_openlineage_namespace uses TERADATA_* config)
- Phase 1-6 (v1.0) error handling → Phase 8 OpenLineage handlers (reuse respondError, slog logging)
- Phase 3 (v1.0) validation → Phase 8 OpenLineage API (reuse parseAndValidateLineageParams)

**Integration Status:**
- 7/8 integration points connected
- 7/7 E2E flows complete
- 1 missing connection: SetPaginationConfig not called (LOW impact)

---

_For current project status, see .planning/PROJECT.md_
_For milestone audit details, see .planning/milestones/v2.0-MILESTONE-AUDIT.md_
