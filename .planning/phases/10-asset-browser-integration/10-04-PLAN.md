---
phase: 10-asset-browser-integration
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - lineage-ui/src/components/domain/AssetBrowser/AssetBrowser.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Column list scrolls table header into view when user changes column pagination page"
    - "Table list scrolls database header into view when user changes table pagination page"
  artifacts:
    - path: "lineage-ui/src/components/domain/AssetBrowser/AssetBrowser.tsx"
      provides: "Scroll-to-top behavior on pagination changes"
      contains: "scrollIntoView"
  key_links:
    - from: "fieldOffset state change"
      to: "scrollIntoView call"
      via: "useEffect watching fieldOffset with ref"
      pattern: "useEffect.*fieldOffset.*scrollIntoView"
---

<objective>
Fix column pagination scroll behavior so users can see the dataset header and new columns without manual scrolling

Purpose: UAT Test 7 revealed that when users click Next/Previous on column pagination, the viewport stays at its current scroll position, requiring users to manually scroll up to find the table header and see the new column page. This creates confusion and poor UX.

Output: DatasetItem component scrolls its parent element into view when fieldOffset changes, ensuring users always see the table header and column list after pagination. Same behavior added to DatabaseItem for table pagination consistency.
</objective>

<execution_context>
@/Users/Daniel.Tehan/.claude/get-shit-done/workflows/execute-plan.md
@/Users/Daniel.Tehan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-asset-browser-integration/10-UAT.md (gap diagnosis)
@lineage-ui/src/components/domain/AssetBrowser/AssetBrowser.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add scroll-into-view behavior on pagination changes</name>
  <files>lineage-ui/src/components/domain/AssetBrowser/AssetBrowser.tsx</files>
  <action>
Add scroll-into-view behavior to both DatasetItem and DatabaseItem components:

**DatasetItem changes (column pagination):**
1. Add `useRef<HTMLLIElement>(null)` to reference the outer `<li>` element
2. Attach ref to the outer `<li>` element: `<li ref={datasetRef}>`
3. Add useEffect that watches `fieldOffset`:
   - Use a ref to track if this is initial mount (skip scroll on mount)
   - When fieldOffset changes (not initial mount), call `datasetRef.current?.scrollIntoView({ behavior: 'smooth', block: 'start' })`

**DatabaseItem changes (table pagination):**
1. Add `useRef<HTMLLIElement>(null)` to reference the outer `<li>` element
2. Attach ref to the outer `<li>` element: `<li ref={databaseRef}>`
3. Add useEffect that watches `tableOffset`:
   - Use a ref to track if this is initial mount (skip scroll on mount)
   - When tableOffset changes (not initial mount), call `databaseRef.current?.scrollIntoView({ behavior: 'smooth', block: 'start' })`

**Pattern for skip-initial-mount:**
```typescript
const isInitialMount = useRef(true);
useEffect(() => {
  if (isInitialMount.current) {
    isInitialMount.current = false;
    return;
  }
  ref.current?.scrollIntoView({ behavior: 'smooth', block: 'start' });
}, [offset]);
```

Import `useRef` if not already imported (it is - check line 1).
  </action>
  <verify>
1. `cd lineage-ui && npm run build` - TypeScript compiles without errors
2. `cd lineage-ui && npm test -- --run AssetBrowser` - Existing tests pass
3. Manual verification: Start app, expand a database, expand a table with many columns (if available), click Next on column pagination - the table header should scroll into view smoothly
  </verify>
  <done>
When user clicks Next/Previous on column pagination, the dataset row scrolls to top of viewport showing table header and new columns. Same behavior for table pagination within databases.
  </done>
</task>

</tasks>

<verification>
1. Build passes: `cd lineage-ui && npm run build`
2. Tests pass: `cd lineage-ui && npm test -- --run`
3. Manual test: Pagination changes trigger smooth scroll to list header
</verification>

<success_criteria>
- Column pagination scroll: When fieldOffset changes, DatasetItem scrolls into view
- Table pagination scroll: When tableOffset changes, DatabaseItem scrolls into view
- No scroll on initial mount (only on user-initiated pagination changes)
- Smooth scroll animation (`behavior: 'smooth'`)
- Build and existing tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/10-asset-browser-integration/10-04-SUMMARY.md`
</output>
