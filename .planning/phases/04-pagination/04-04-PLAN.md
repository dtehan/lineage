---
phase: 04-pagination
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - lineage-ui/src/components/common/Pagination.tsx
  - lineage-ui/src/components/common/Pagination.test.tsx
  - lineage-ui/src/components/domain/AssetBrowser/AssetBrowser.tsx
  - lineage-ui/src/components/domain/AssetBrowser/AssetBrowser.test.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "User can navigate to next/previous pages of database list"
    - "User sees current page indicator (e.g., 'Showing 1-100 of 250')"
    - "Page transitions are smooth with keepPreviousData"
  artifacts:
    - path: "lineage-ui/src/components/common/Pagination.tsx"
      provides: "Reusable pagination controls component"
      exports: ["Pagination"]
    - path: "lineage-ui/src/components/domain/AssetBrowser/AssetBrowser.tsx"
      provides: "AssetBrowser with pagination integration"
      contains: "Pagination"
  key_links:
    - from: "AssetBrowser.tsx"
      to: "useDatabases hook"
      via: "pagination state"
      pattern: "useDatabases.*limit.*offset"
    - from: "Pagination.tsx"
      to: "parent component"
      via: "onPageChange callback"
      pattern: "onPageChange"
---

<objective>
Close gap PAGE-UI-01: Frontend pagination controls not implemented.

Purpose: Users need to navigate paginated results in the AssetBrowser. Hooks already support pagination parameters (limit, offset) and return metadata (total_count, has_next), but the UI has no controls to change pages.

Output:
- Reusable Pagination component with prev/next buttons and page info
- AssetBrowser integration with pagination state for database list
</objective>

<execution_context>
@/Users/Daniel.Tehan/.claude/get-shit-done/workflows/execute-plan.md
@/Users/Daniel.Tehan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-pagination/04-VERIFICATION.md
@.planning/phases/04-pagination/04-03-SUMMARY.md

@lineage-ui/src/api/hooks/useAssets.ts
@lineage-ui/src/types/index.ts
@lineage-ui/src/components/domain/AssetBrowser/AssetBrowser.tsx
@lineage-ui/src/components/common/Button.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create reusable Pagination component</name>
  <files>
    lineage-ui/src/components/common/Pagination.tsx
    lineage-ui/src/components/common/Pagination.test.tsx
  </files>
  <action>
Create a reusable Pagination component in lineage-ui/src/components/common/Pagination.tsx:

```typescript
interface PaginationProps {
  totalCount: number;
  limit: number;
  offset: number;
  onPageChange: (offset: number) => void;
  className?: string;
}
```

Component features:
1. Shows "Showing X-Y of Z" text (e.g., "Showing 1-100 of 250")
2. Prev button: disabled when offset === 0
3. Next button: disabled when offset + limit >= totalCount
4. Use Tailwind classes matching existing Button.tsx patterns (slate colors, hover states)
5. Use ChevronLeft and ChevronRight from lucide-react icons (already in codebase)

Create test file Pagination.test.tsx:
- Test shows correct range text for various offset/limit/total combinations
- Test prev button disabled state when offset=0
- Test next button disabled state when at last page
- Test onPageChange called with correct offset on button clicks
  </action>
  <verify>
Run: `cd lineage-ui && npm test -- --run Pagination`
All tests pass.
  </verify>
  <done>
Pagination component exists with prev/next buttons, page info display, and passing tests.
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate pagination into AssetBrowser database list</name>
  <files>
    lineage-ui/src/components/domain/AssetBrowser/AssetBrowser.tsx
    lineage-ui/src/components/domain/AssetBrowser/AssetBrowser.test.tsx
  </files>
  <action>
Update AssetBrowser.tsx to use pagination state for the database list:

1. Add pagination state:
```typescript
const [databasePagination, setDatabasePagination] = useState({ limit: 100, offset: 0 });
```

2. Pass pagination to useDatabases hook:
```typescript
const { data: databasesResult, isLoading } = useDatabases(databasePagination);
```

3. Add Pagination component below the database list:
```typescript
{databasesResult?.pagination && databasesResult.pagination.total_count > databasePagination.limit && (
  <Pagination
    totalCount={databasesResult.pagination.total_count}
    limit={databasePagination.limit}
    offset={databasePagination.offset}
    onPageChange={(offset) => setDatabasePagination(prev => ({ ...prev, offset }))}
    className="mt-2 px-2"
  />
)}
```

4. Only show pagination if total exceeds page size (avoid clutter for small lists)

Update AssetBrowser.test.tsx:
- Add test: pagination controls visible when total > limit
- Add test: pagination controls hidden when total <= limit
- Add test: clicking next updates offset and refetches
- Update existing mock data to include pagination metadata
  </action>
  <verify>
Run: `cd lineage-ui && npm test -- --run AssetBrowser`
All tests pass.
  </verify>
  <done>
AssetBrowser shows pagination controls for database list when results exceed page size. Users can navigate pages.
  </done>
</task>

</tasks>

<verification>
1. Run full test suite: `cd lineage-ui && npm test -- --run`
2. Verify no TypeScript errors: `cd lineage-ui && npx tsc --noEmit`
3. Visual check: Start dev server and confirm pagination appears for database list
</verification>

<success_criteria>
- Pagination component created with prev/next buttons and "Showing X-Y of Z" info
- AssetBrowser integrates pagination for database list
- Page navigation updates offset state and triggers data refetch
- All existing tests pass
- New pagination tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/04-pagination/04-04-SUMMARY.md`
</output>
