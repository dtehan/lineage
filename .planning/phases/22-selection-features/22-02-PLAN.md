---
phase: 22-selection-features
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - lineage-ui/src/components/domain/LineageGraph/DetailPanel/SelectionBreadcrumb.tsx
  - lineage-ui/src/components/domain/LineageGraph/DetailPanel.tsx
autonomous: true

must_haves:
  truths:
    - "Panel header shows selection hierarchy breadcrumb (database > table > column)"
    - "Breadcrumb updates immediately when user changes selection"
    - "Long database/table/column names truncate with ellipsis and show full name on hover"
    - "Breadcrumb only appears for column selections, not edge selections"
  artifacts:
    - path: "lineage-ui/src/components/domain/LineageGraph/DetailPanel/SelectionBreadcrumb.tsx"
      provides: "Breadcrumb component displaying database > table > column hierarchy"
      exports: ["SelectionBreadcrumb"]
    - path: "lineage-ui/src/components/domain/LineageGraph/DetailPanel.tsx"
      provides: "Updated entity header section using SelectionBreadcrumb"
      contains: "SelectionBreadcrumb"
  key_links:
    - from: "DetailPanel.tsx"
      to: "SelectionBreadcrumb.tsx"
      via: "import and render in entity header section"
      pattern: "SelectionBreadcrumb.*databaseName.*tableName.*columnName"
    - from: "SelectionBreadcrumb.tsx"
      to: "selectedColumn prop data"
      via: "receives databaseName, tableName, columnName as props from DetailPanel"
      pattern: "databaseName.*tableName.*columnName"
---

<objective>
Add selection hierarchy breadcrumb to the DetailPanel header.

Purpose: Users need clear context about what they've selected in the graph. The breadcrumb shows the full hierarchy (database > table > column) in a scannable format with icons, replacing the current plain text header.
Output: `SelectionBreadcrumb` component and updated DetailPanel entity header.
</objective>

<execution_context>
@/Users/Daniel.Tehan/.claude/get-shit-done/workflows/execute-plan.md
@/Users/Daniel.Tehan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-selection-features/22-RESEARCH.md

@lineage-ui/src/components/domain/LineageGraph/DetailPanel.tsx
@lineage-ui/src/components/domain/LineageGraph/DetailPanel/TabBar.tsx
@lineage-ui/src/components/domain/LineageGraph/DetailPanel/ColumnsTab.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SelectionBreadcrumb component</name>
  <files>
    lineage-ui/src/components/domain/LineageGraph/DetailPanel/SelectionBreadcrumb.tsx
  </files>
  <action>
Create `SelectionBreadcrumb.tsx` in the `DetailPanel/` directory (alongside TabBar.tsx, ColumnsTab.tsx, etc.):

```typescript
import React from 'react';
import { ChevronRight, Database, Table as TableIcon, Columns } from 'lucide-react';

interface SelectionBreadcrumbProps {
  databaseName: string;
  tableName: string;
  columnName: string;
}

export const SelectionBreadcrumb: React.FC<SelectionBreadcrumbProps> = ({
  databaseName,
  tableName,
  columnName,
}) => {
  return (
    <nav
      aria-label="Selection hierarchy"
      className="flex items-center gap-1 text-xs overflow-hidden"
    >
      <Database className="w-3 h-3 flex-shrink-0 text-slate-400" />
      <span className="text-slate-500 truncate max-w-[80px]" title={databaseName}>
        {databaseName}
      </span>
      <ChevronRight className="w-3 h-3 flex-shrink-0 text-slate-300" />
      <TableIcon className="w-3 h-3 flex-shrink-0 text-slate-400" />
      <span className="text-slate-500 truncate max-w-[80px]" title={tableName}>
        {tableName}
      </span>
      <ChevronRight className="w-3 h-3 flex-shrink-0 text-slate-300" />
      <Columns className="w-3 h-3 flex-shrink-0 text-blue-500" />
      <span className="font-medium text-slate-700 truncate" title={columnName}>
        {columnName}
      </span>
    </nav>
  );
};
```

Design choices (from research):
- Uses `Database`, `Table` (aliased as `TableIcon` to avoid JSX conflict), `Columns` icons from lucide-react -- already installed
- `ChevronRight` separators match the AssetBrowser hierarchy pattern
- `max-w-[80px]` on database and table names prevents long names from pushing column name off screen
- Column name (the selected item) gets `font-medium text-slate-700` to stand out visually -- it's the "active" breadcrumb segment
- Database and table icons are `text-slate-400`, column icon is `text-blue-500` to match the selection highlight color
- `title` attributes on all spans show full names on hover when truncated
- `overflow-hidden` on nav container prevents any overflow from the 384px panel width
- `aria-label="Selection hierarchy"` for accessibility
  </action>
  <verify>
Run `cd /Users/Daniel.Tehan/Code/lineage/lineage-ui && npx tsc --noEmit` to verify no TypeScript errors. Verify the file exists at the correct path.
  </verify>
  <done>
`SelectionBreadcrumb` component exists with `databaseName`, `tableName`, `columnName` props. Icons from lucide-react. Truncation with `max-w-[80px]` and `title` hover. Accessible `nav` element with aria-label.
  </done>
</task>

<task type="auto">
  <name>Task 2: Replace entity header in DetailPanel with breadcrumb</name>
  <files>
    lineage-ui/src/components/domain/LineageGraph/DetailPanel.tsx
  </files>
  <action>
Modify `DetailPanel.tsx` to use the new breadcrumb component:

**1. Add import:**
At the top, after the existing DetailPanel sub-component imports (TabBar, ColumnsTab, etc.), add:
```typescript
import { SelectionBreadcrumb } from './DetailPanel/SelectionBreadcrumb';
```

**2. Replace the entity header in `renderColumnTabbed()`:**
Find the entity header section (lines 172-180):
```tsx
{/* Entity header */}
<div className="px-4 py-2 border-b border-slate-100">
  <h3 className="text-sm font-semibold text-slate-800 break-all">
    {selectedColumn.databaseName}.{selectedColumn.tableName}
  </h3>
  <p className="text-xs text-slate-500 mt-0.5">
    Selected: <span className="font-medium text-slate-600">{selectedColumn.columnName}</span>
  </p>
</div>
```

Replace it with:
```tsx
{/* Selection breadcrumb */}
<div className="px-4 py-2 border-b border-slate-100">
  <SelectionBreadcrumb
    databaseName={selectedColumn.databaseName}
    tableName={selectedColumn.tableName}
    columnName={selectedColumn.columnName}
  />
</div>
```

This replaces the two-line header (database.table + "Selected: column") with a single-line breadcrumb that shows the same information in a more structured format with icons. The `px-4 py-2 border-b border-slate-100` container styling stays the same to maintain the visual layout.

The breadcrumb updates immediately on selection change because `selectedColumn` is a prop derived from `selectedAssetId` in the Zustand store. When a new column is clicked, `selectedAssetId` changes -> `getColumnDetail()` returns new data -> `selectedColumn` prop updates -> breadcrumb re-renders with new values.
  </action>
  <verify>
Run `cd /Users/Daniel.Tehan/Code/lineage/lineage-ui && npx tsc --noEmit` to verify no TypeScript errors. Run `cd /Users/Daniel.Tehan/Code/lineage/lineage-ui && npm test -- --run` to verify existing DetailPanel tests pass. Some tests that check for the old "Selected:" text or "databaseName.tableName" format may need adjustment -- check test output and fix any assertion failures by updating test expectations to match the new breadcrumb format.

If tests fail because they look for the old header text:
- Tests checking for `databaseName.tableName` text: Update to check for breadcrumb elements. The database name and table name still appear as separate text nodes. Use `getByText('test_db')` and `getByText('test_table')` instead of `getByText('test_db.test_table')`.
- Tests checking for `"Selected: customer_id"` text: The breadcrumb renders column name directly. Use `getByText('customer_id')` instead.
- Tests using `getByLabelText('Selection hierarchy')` can verify the breadcrumb nav element exists.
  </verify>
  <done>
DetailPanel entity header replaced with `SelectionBreadcrumb` component. Breadcrumb shows `database > table > column` with icons. Updates immediately on selection change (reactive via props). All DetailPanel tests pass (with any necessary assertion updates for the new format).
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with zero errors
2. `npm test -- --run` passes all tests (including updated DetailPanel tests)
3. `SelectionBreadcrumb.tsx` exists in `DetailPanel/` directory
4. DetailPanel renders breadcrumb instead of old two-line header
5. Breadcrumb shows three segments with icons and chevron separators
6. Long names truncate with ellipsis and show full text on hover via `title` attribute
</verification>

<success_criteria>
- SelectionBreadcrumb renders database > table > column with Database/Table/Columns icons
- ChevronRight separators between segments
- Column name emphasized with `font-medium text-slate-700`
- Truncation with `max-w-[80px]` on database and table names prevents overflow
- `title` attributes provide full names on hover
- Breadcrumb only appears for column selections (edge selections use existing flat layout)
- Breadcrumb updates immediately when different column is clicked (reactive props)
- All existing tests pass (with updated assertions for new breadcrumb format)
</success_criteria>

<output>
After completion, create `.planning/phases/22-selection-features/22-02-SUMMARY.md`
</output>
